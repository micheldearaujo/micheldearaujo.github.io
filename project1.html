<!DOCTYPE HTML>
<!--
	Solid State by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Discoverying Brazilian Real State in numbers</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
	</head>
	<body class="is-preload">

		<!-- Page Wrapper -->
			<div id="page-wrapper">

				<!-- Header -->
					<header id="header">
						<h1><a href="index.html">Michel de Araújo</a></h1>
<!--						<nav>-->
<!--							<a href="#menu">Menu</a>-->
<!--						</nav>-->
					</header>

				<!-- Menu -->
<!--					<nav id="menu">-->
<!--						<div class="inner">-->
<!--							<h2>Menu</h2>-->
<!--							<ul class="links">-->
<!--								<li><a href="index.html">Home</a></li>-->
<!--								<li><a href="generic.html">Generic</a></li>-->
<!--								<li><a href="elements.html">Elements</a></li>-->
<!--								<li><a href="#">Log In</a></li>-->
<!--								<li><a href="#">Sign Up</a></li>-->
<!--							</ul>-->
<!--							<a href="#" class="close">Close</a>-->
<!--						</div>-->
<!--					</nav>-->

				<!-- Wrapper -->
					<section id="wrapper">
						<header>
							<div class="inner">
								<h2>Analysis of rent prices distribution in Brazil</h2>
								<p>Discoverying Brazilian Real State in numbers.</p>
							</div>
						</header>

						<!-- Content -->
							<div class="wrapper">
								<div class="inner">

									<h2 class="major">Introduction</h2>
									<p>During my childhood, for various reasons, my family always had to move constantly. Today, at 23, I have moved 12 times and counting.
										It was practically once every two years. This lifestyle can have its upsides, such as always meeting new places, new people,
										new experiences and getting out of the box when discovering that the world is much more than it appears. However, always moving
										home brings with it some unwanted hassles, such as always spending money on furniture shipping, dealing with broken furniture in transportation,
										and finding good schools for the children (this part is quite difficult from my experience!). In addition to all of this, there is the difficult task of finding the perfect property,
										or at least close to perfection, that offers everything you are looking for combined with a fair price - the famous cost-benefit. Factors such as size, number of bedrooms, bathrooms,
										parking spaces and especially the location greatly affect the price of a house or apartment. At 22 I decided to leave my family's house and gather the rags with my girlfriend,
										and that's when I came across with all the difficulties and concerns that a child can't imagine. It was based on this that I decided to do this project, to get to know a little more
										about the Brazilian real estate market, not only from an economic point of view but from a practical point of view. Is it worth to rent a house with more space or is a studio apartment enough?
										Should I spend more living downtown near work where prices are higher and apartments are small, or should I spend less in a house further away? This is a very important decision to make,
										as it requires both physical and mental effort. This project is also suitable for those who have a property and want to rent it but have no idea how to price their house or apartment.
										It is possible to create a Machine Learning (ML) model to, through the data collected from properties throughout Brazil, determine, through the characteristics of your property, its rental price.</p>

									<p>This work will be constructed as follows: I will collect information about real estate via Webscraping using the Python programming language, together with the Selenium library, which allows me to
										browse web pages, interact with them and extract information. With the raw data, I will use the R language to perform all the data analysis: Cleaning, transformation, exploratory analysis and construction
										of the ML model to predict the price based on the houses characteristics. I thought that a good way to carry out this analysis would be to use a common site for renting and selling real estate, because there
										individuals and brokerages advertise their products. All the rest of the analysis will be done using the R language. You will probably need to do a good job of extracting data from strings, using regular expressions and splits.</p>

									<p>This analysis will be very useful for two different audiences. The first is people in general, who are looking for a new place to live and want to make an assertive decision based on real data. Through this analysis the user will be able
										to decide which type of property suits his needs, whether it is a house or apartment, whether it is near or far from the center, large or small, etc. The second audience is made up both of people in general, who own a property and
										wish to rent it but do not know how much it is worth, and for realtors, who technically do the same, but with third-party properties. This way, the client will be able to know more assertively what the value of his property should be
										based on hundreds of other properties with similar characteristics, from the same neighborhood and from nearby neighborhoods.</p>

									<h2 class="major">Necessary packages</h2>
									The following R packages will be necessary to develop this project:
									<pre><code>
library(dplyr) # String manipulation functions
library(readr) # Reading files and parse_number functions
library(stringr) # String manipulation
library(tidyr) # Data manipulation
library(DT) # Interactive tables
library(tidygeocoder) # Extract geographical informations from addresses
library(ggplot2) # Static graphics
library(plotly) # Interactive graphics
library(ggpubr) # Make subplots with ggplot2
require(nortest) # Anderson-DarlingHypothesis test
library(RColorBrewer) # More palette colors
library(rnaturalearth) # Getting sf maps
library(classInt) # Categorization of continuous variables</code></pre>
									<h2 class="major">Chapter 1: Data cleaning and transformation</h2>
									<p>All data were extracted via Webscraping from only one website, Zap Imóveis. This website allows one to filter between buying, renting, property type and location. The site presents different types of properties, such as apartment, studio, kitnet house, condominium house, village house, penthouse, flat, loft, land, and several other types of commercial establishments. In this project we will focus only on residential properties of the house and apartment type. The original purpose of the data is the commercialization of real estate, as it is a website where anyone can advertise their property for sale or rent. As the Webscraping process depends a lot on the internet speed, I collected all ads during the period from April to June. It may have taken longer than necessary, but I was still learning about the automation process and I certainly made some redundancies in the algorithm (for example, I had to go manually choosing geographic regions because it is only possible to filter up to 5 regions and the site do not makes all pages available without filtering.) The Webscraping process returns a string containing all the information of the ad in question, as can be seen in Figure 1. Thus,
									the original form of the dataframe has only one variable.However, more variables will be created during the transformation process.</p>

									<h3>Import and getting to know the data</h3>
									<p>Let's get to work! The first step is to import the data and visualize its structure.
									<pre><code>
anuncios <- read.csv('housing_prices.csv')
print('Dataframe structure: ')
str(anuncios)

# Result
## 'data.frame':    39912 obs. of  1 variable:
##  $ Anuncio: chr  "super destaque apartamento para alugar em\r\nRua da República - Cidade Baixa, Porto Alegre - RS\r\nR$ 1.300 /mê"| __truncated__ "apartamento para alugar em\r\nRua Cônego Ladeira, 57 - Vila Mazzei, São Paulo - SP\r\nR$ 1.500 /mês\r\ncondomín"| __truncated__ "apartamento para alugar em\r\nCentro Histórico, Porto Alegre - RS\r\nR$ 700 /mês\r\ncondomínio R$ 220 IPTU R$ 3"| __truncated__ "apartamento para alugar em\r\nRua Marquês de Valença - Móoca, São Paulo - SP\r\nR$ 1.450 /mês\r\ncondomínio R$ "| __truncated__ ...
##  - attr(*, "spec")=
##   .. cols(
##   ..   Anuncio = col_character()
##   .. )
									</code></pre>
									Let us print a few lines to see how the ads are written:
									<pre><code>
head(anuncios,5)

## Anuncio
## 1  super destaque apartamento para alugar em\r\nRua da República - Cidade Baixa, Porto Alegre - RS\r\nR$ 1.300 /mês\r\ncondomínio R$ 516 IPTU R$ 53 aluguel e condomínioR$ 1.816\r\n61 m²\r\n1 quarto\r\n1 banheiro
## 2  apartamento para alugar em\r\nRua Cônego Ladeira, 57 - Vila Mazzei, São Paulo - SP\r\nR$ 1.500 /mês\r\ncondomínio R$ 100 IPTU R$ 32 aluguel e condomínioR$ 1.600\r\n42 m²\r\n2 quartos\r\n1 banheiro
## 3  apartamento para alugar em\r\nCentro Histórico, Porto Alegre - RS\r\nR$ 700 /mês\r\ncondomínio R$ 220 IPTU R$ 35 aluguel e condomínioR$ 920\r\n35 m²\r\n1 quarto\r\n2 banheiros
## 4  apartamento para alugar em\r\nRua Marquês de Valença - Móoca, São Paulo - SP\r\nR$ 1.450 /mês\r\ncondomínio R$ 850 IPTU não informado aluguel e condomínioR$ 2.300\r\n56 m²\r\n2 quartos\r\n1 vaga\r\n2 banheiros
## 5  apartamento para alugar em\r\nGleba Palhano, Londrina - PR\r\nR$ 950 /mês\r\ncondomínio R$ 280 IPTU não informado aluguel e condomínioR$ 1.230\r\n45 m²\r\n2 quartos\r\n1 vaga\r\n1 banheiro
									</code></pre>
									Therefore, what we have here is the raw text of 39912 houses and apartaments announcements in Brazil.
									The objective is to separate this lines breaks ("\r\n") into each characteristic of the property so we can study
									the problem and make conclusions about it.
									</p>
									<h3>Cleaning and transformation</h3>
									<p>
										First, it is important to understand why the cleaning and transformation steps are together.
										That is because the two processes will happen simultaneously, sometimes transforming,
										sometimes performing deleting some rows. The first step in cleaning and transforming is to
										create a column that tells you whether the property is a house (CS) or apartment (AP) type.
										For this I will use the <code>str_extract_all</code> function, from the <em>stringr</em> package.
									</p>

									<h4>The "Type" variable</h4>
									<p>
										<pre><code>
anuncios$Tipo <- unlist(str_extract_all(pattern = 'apartamento|casa|sobrado', string = anuncios$Anuncio))

## Error in `$<-.data.frame`(`*tmp*`, Tipo, value = c("apartamento", "apartamento", : replacement has 39764 rows, data has 39912
										</code></pre>
									An error was returned. It says that the quantity of items to add to the dataframe is less than the quantity of rows in the dataframe.
									This happened because not all ads specified whether it was a house or apartment or townhouse (which is a type of house). As the amount
									of ads without this information is relatively low (148 out of 39912 ads),
									I will remove the lines that do not have this information and then extract the “Type” information.
										<pre><code>
anuncios <- data.frame(Anuncio = anuncios[grepl(pattern = 'casa|apartamento|sobrado', x = anuncios$Anuncio), ])
anuncios$Tipo <- unlist(str_extract_all(pattern = 'apartamento|casa|sobrado', string = anuncios$Anuncio))
										</code></pre>
									The <code>grepl</code> function returns <code>TRUE</code> for a row when it matches the pattern and
									<code>FALSE</code> otherwise. Now, for simplicity, lets use initials instead of the full name,
									Where 'AP' stands for apartament and 'CS' stands for house.
										<pre><code>
anuncios$Tipo <- gsub(pattern='apartamento', replacement='AP', x=anuncios$Tipo)
anuncios$Tipo <- gsub(pattern='casa|sobrado', replacement='CS', x=anuncios$Tipo)
										</code></pre>
									Look at that, we have got our first information!
									</p>

									<h4 class="major">the "Price" variable</h4>
									<p>
									Next, let's extract the rental value from the property.
									To make the process easier, let's create a vector that contains all ads but separated in their line breaks, as follows
										<pre><code>
dados <- unlist(strsplit(x = anuncios$Anuncio, split='\n'))
head(dados, 10)

##  [1] "super destaque apartamento para alugar em\r"
##  [2] "Rua da República - Cidade Baixa, Porto Alegre - RS\r"
##  [3] "R$ 1.300 /mês\r"
##  [4] "condomínio R$ 516 IPTU R$ 53 aluguel e condomínioR$ 1.816\r"
##  [5] "61 m²\r"
##  [6] "1 quarto\r"
##  [7] "1 banheiro"
##  [8] "apartamento para alugar em\r"
##  [9] "Rua Cônego Ladeira, 57 - Vila Mazzei, São Paulo - SP\r"
## [10] "R$ 1.500 /mês\r"
										</code></pre>
									Why create such a vector? The grep function returns only those elements of an array that have the established pattern.
									If I used grep in the ad column itself, it would return the entire row since it's a single string. By separating each ad into multiple vectors,
									through the line break, I get multiple lines, and only one line per ad contains the rental price. This way, when using grep, only the lines with the
									price will be returned.
									As each ad has only one piece of information of each type, this process will not change our data. So, we can extract the rent amount:
										<pre><code>
anuncios$Preco <- grep(pattern = '/mês', x = dados, value = TRUE)

## Error in `$<-.data.frame`(`*tmp*`, Preco, value = c("R$ 1.300 /mês\r", : replacement has 39123 rows, data has 39764
										</code></pre>
									Another error stating that the new column has fewer rows than the dataframe. Let's see what's going on.
										<pre><code>
head(data.frame(anuncios[!grepl(pattern = '/mês', x = anuncios$Anuncio), ]), 3)

##                                                                                                                                                                                                                   Anuncio
## 9   destaque apartamento para alugar em\r\nRua Augusto Severo Neto, 84 - Pirangi do Norte, Parnamirim - RN\r\nR$ 800 /dia\r\ncondomínio não informado IPTU não informado\r\n120 m²\r\n2 quartos\r\n2 vagas\r\n2 banheiros
## 65                                               apartamento para alugar em\r\nPrainha, Arraial do Cabo - RJ\r\nR$ 420 /dia\r\ncondomínio não informado IPTU não informado\r\n80 m²\r\n2 quartos\r\n1 vaga\r\n2 banheiros
## 143                             apartamento para alugar em\r\nQuadra Mar Centro, Balneário Camboriú - SC\r\nR$ 1.000 /dia\r\ncondomínio não informado IPTU não informado\r\n104 m²\r\n3 quartos\r\n2 vagas\r\n2 banheiros
##     Tipo
## 9     AP
## 65    AP
## 143   AP
										</code></pre>
									As can be seen, some advertisements inform the rental value using the word “Rent” and other advertisements are advertised dayily “/day”. As we are only interested in monthly rents, we will exclude daily rents.
										<pre><code>
anuncios <- data.frame(anuncios[grepl(pattern = 'Aluguel|/mês', x = anuncios$Anuncio), ])
										</code></pre>
									Note that after deleting some lines of the dataframe, it is necessary to redefine the "data" vector, which contains all the lines of the advertisements.
										<pre><code>
dados <- unlist(strsplit(x = anuncios$Anuncio, split = '\n'))
										</code></pre>
									Now it is possible to extract the "Price".
										<pre><code>
anuncios$Preco <- grep(pattern = '/mês|Aluguel', x = dados, value=TRUE)
head(anuncios, 2)

##                                                                                                                                                                                                            Anuncio
## 1 super destaque apartamento para alugar em\r\nRua da República - Cidade Baixa, Porto Alegre - RS\r\nR$ 1.300 /mês\r\ncondomínio R$ 516 IPTU R$ 53 aluguel e condomínioR$ 1.816\r\n61 m²\r\n1 quarto\r\n1 banheiro
## 2             apartamento para alugar em\r\nRua Cônego Ladeira, 57 - Vila Mazzei, São Paulo - SP\r\nR$ 1.500 /mês\r\ncondomínio R$ 100 IPTU R$ 32 aluguel e condomínioR$ 1.600\r\n42 m²\r\n2 quartos\r\n1 banheiro
##   Tipo           Preco
## 1   AP R$ 1.300 /mês\r
## 2   AP R$ 1.500 /mês\r
										</code></pre>
									Now we have the column with the prices. However, it is still necessary to carry out the cleaning and keep only the values. For this, I will use the parse_number function.
										<pre><code>
anuncios$Preco <- parse_number(x = anuncios$Preco, locale = locale(decimal_mark= ',' , grouping_mark = '.'))
head(anuncios, 2)

##                                                                                                                                                                                                            Anuncio
## 1 super destaque apartamento para alugar em\r\nRua da República - Cidade Baixa, Porto Alegre - RS\r\nR$ 1.300 /mês\r\ncondomínio R$ 516 IPTU R$ 53 aluguel e condomínioR$ 1.816\r\n61 m²\r\n1 quarto\r\n1 banheiro
## 2             apartamento para alugar em\r\nRua Cônego Ladeira, 57 - Vila Mazzei, São Paulo - SP\r\nR$ 1.500 /mês\r\ncondomínio R$ 100 IPTU R$ 32 aluguel e condomínioR$ 1.600\r\n42 m²\r\n2 quartos\r\n1 banheiro
##   Tipo Preco
## 1   AP  1300
## 2   AP  1500
										</code></pre>
									Now we have both the property type and its price!
									</p>

									<p>
									<h4 class="major">The "Area" variable</h4>
									The property size is a must have information when it comes to living confort and real state business.
									Note that all advertisements presents this information in the structure "number + m^2". Therefore,
										<pre><code>
anuncios$Area <- grep(pattern = '[0-9]+\\sm', x = dados, value = TRUE)
head(anuncios, 2)

##                                                                                                                                                                                                            Anuncio
## 1 super destaque apartamento para alugar em\r\nRua da República - Cidade Baixa, Porto Alegre - RS\r\nR$ 1.300 /mês\r\ncondomínio R$ 516 IPTU R$ 53 aluguel e condomínioR$ 1.816\r\n61 m²\r\n1 quarto\r\n1 banheiro
## 2             apartamento para alugar em\r\nRua Cônego Ladeira, 57 - Vila Mazzei, São Paulo - SP\r\nR$ 1.500 /mês\r\ncondomínio R$ 100 IPTU R$ 32 aluguel e condomínioR$ 1.600\r\n42 m²\r\n2 quartos\r\n1 banheiro
##   Tipo Preco    Area
## 1   AP  1300 61 m²\r
## 2   AP  1500 42 m²\r
										</code></pre>

									</p>


									<h2 class="major">Chapter 2: Exploratory Data Analysis</h2>

									<h2 class="major">Chapter 3: Geoespacial Analysis</h2>

									<h2 class="major">Vitae phasellus</h2>
									<p>Cras mattis ante fermentum, malesuada neque vitae, eleifend erat. Phasellus non pulvinar erat. Fusce tincidunt, nisl eget mattis egestas, purus ipsum consequat orci, sit amet lobortis lorem lacus in tellus. Sed ac elementum arcu. Quisque placerat auctor laoreet.</p>

									<section class="features">
										<article>
											<a href="#" class="image"><img src="images/pic04.jpg" alt="" /></a>
											<h3 class="major">Sed feugiat lorem</h3>
											<p>Lorem ipsum dolor sit amet, consectetur adipiscing vehicula id nulla dignissim dapibus ultrices.</p>
											<a href="#" class="special">Learn more</a>
										</article>
										<article>
											<a href="#" class="image"><img src="images/pic05.jpg" alt="" /></a>
											<h3 class="major">Nisl placerat</h3>
											<p>Lorem ipsum dolor sit amet, consectetur adipiscing vehicula id nulla dignissim dapibus ultrices.</p>
											<a href="#" class="special">Learn more</a>
										</article>
									</section>

								</div>
							</div>

					</section>

				<!-- Footer -->
					<section id="footer">
						<div class="inner">
							<h2 class="major">Get in touch</h2>
							<p>Cras mattis ante fermentum, malesuada neque vitae, eleifend erat. Phasellus non pulvinar erat. Fusce tincidunt, nisl eget mattis egestas, purus ipsum consequat orci, sit amet lobortis lorem lacus in tellus. Sed ac elementum arcu. Quisque placerat auctor laoreet.</p>
<!--							<form method="post" action="#">
								<div class="fields">
									<div class="field">
										<label for="name">Name</label>
										<input type="text" name="name" id="name" />
									</div>
									<div class="field">
										<label for="email">Email</label>
										<input type="email" name="email" id="email" />
									</div>
									<div class="field">
										<label for="message">Message</label>
										<textarea name="message" id="message" rows="4"></textarea>
									</div>
								</div>
								<ul class="actions">
									<li><input type="submit" value="Send Message" /></li>
								</ul>
							</form>-->
							<ul class="contact">
								<li class="icon solid fa-home">
									Vasco da Gama, Recife<br />
									Pernambuco, Brazil.
								</li>
								<li class="icon solid fa-phone">(+55) 08198480-2352</li>
								<li class="icon solid fa-envelope"><a href="#">michelarrudala@gmail.com</a></li>
								<!-- <li class="icon brands fa-twitter"><a href="#">twitter.com/untitled-tld</a></li> -->
								<li class="icon brands fa-linkedin"><a href="https://www.linkedin.com/in/michel-de-ara%C3%BAjo-947377197/">Linkedin</a></li>
								<!-- <li class="icon brands fa-instagram"><a href="#">instagram.com/untitled-tld</a></li> -->
							</ul>
							<ul class="copyright">
								<li>&copy; Michel de Araújo. All rights reserved.</li><li>Design: <a href="http://html5up.net">HTML5 UP</a></li>
							</ul>
						</div>
					</section>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>